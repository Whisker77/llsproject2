# 当日作业
# 1.说出实现text2sql的实现思路有哪几种？
# 2.ECharts 图表生成工具（支持折线图、饼图、柱状图）的实现思路是怎样的？
# 3.外部调用dify echarts工作流的示例，并提供运行结果截图。
# 4.完成一个文本-》sql->运行sql->echarts图表输出的技术实现方案，并提供运行截图。

1.①在dify中部署一个llm，提示词写得充分具体，告诉llm什么样的用户输入要对应输出什么样的sql语句。llm输出的sql语句传给数据库查询插件，
  这个插件会连接数据库做查询并在dify输出；
  ②使用vanna.ai。首先先把本地ollama部署的大模型配置给到vanna把数据表的表结构，业务文档，示例sql语句用来训练vanna。
    后续写一个接口方法调用vanna封装好的方法，可以生成所需sql并执行sql。
    用户在接口中传入中文指令就能返回相关数据库数据。
  ③把dify的工作流api和url配置给py脚本，然后把调用dify工作流的接口封装到脚本中，给封装好的方法传具体的中文查询需求，
    在py文件中使用dify工作流做数据库查询。

2. 在dify中创建对话工作流，接一个条件分支，分别对应用户输入的柱状图、折线图、饼图。
   一个条件接一个llm，llm提示词规定大模型输出的相关echarts代码格式到直接回复块，dify自行渲染生成图像。

3. 在py文件中定义dify的客户端类，集成了dify工作流应用的api和url。其中封装的方法可以启动工作流来获取应用回复输出。
   再起一个echarts类，这个类的实例可以调用dify的通用客户端类，并把通用客户端类方法的输出再次加工成可读性强的返回值。
   在api接口中调用这个方法，前端只需要传入需求字符串，api便能返回相应的echarts代码。

4.dify工作流：用户输入→条件判断那种图形→llm→sql语句→数据库查询→llm→echarts代码配置→渲染生成图像



